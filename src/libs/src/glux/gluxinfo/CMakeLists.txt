CMAKE_MINIMUM_REQUIRED(VERSION 2.6)
PROJECT(gluxinfo)

SET(GLUXINFO_SOURCES 
gluxinfo.cpp
)
		
SET(GLUXINFO_HEADERS 
)

FIND_PACKAGE(Perl)
FIND_PACKAGE(OpenGL)

ADD_CUSTOM_COMMAND(
   OUTPUT ${CMAKE_CURRENT_SOURCE_DIR}/gluxinfo.cpp
   COMMAND ${PERL_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/../script/gen_gluxinfo.pl ${CMAKE_CURRENT_SOURCE_DIR}/../src
)

INCLUDE_DIRECTORIES(../../..)
LINK_DIRECTORIES(${LIBSL_BINARY_DIR}) 

ADD_DEFINITIONS(-DUSE_GLUX)
IF(NOT WIN32)
ADD_DEFINITIONS(-DGL_ARB_multitexture=1)  # hack due to MESA headers including ARB_multitexture
ENDIF(NOT WIN32)

FIND_PACKAGE(OpenGL)

ADD_EXECUTABLE(gluxinfo ${GLUXINFO_SOURCES})
IF(WIN32)
TARGET_LINK_LIBRARIES(gluxinfo LibSL LibSL_gl ${OPENGL_LIBRARIES})
INSTALL(PROGRAMS "${CMAKE_CURRENT_BINARY_DIR}/release/gluxinfo.exe" DESTINATION ${CMAKE_SOURCE_DIR}/bin)
ELSE(WIN32)
FIND_PACKAGE(GLUT)
TARGET_LINK_LIBRARIES(gluxinfo LibSL LibSL_gl ${GLUT_LIBRARIES} ${OPENGL_LIBRARIES})
INSTALL(PROGRAMS "${CMAKE_CURRENT_BINARY_DIR}/gluxinfo" DESTINATION ${CMAKE_SOURCE_DIR}/bin)
ENDIF(WIN32)

